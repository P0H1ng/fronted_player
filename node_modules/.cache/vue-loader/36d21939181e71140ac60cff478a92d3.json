{"remainingRequest":"/home/kali/fronted_player/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/kali/fronted_player/src/components/LiveLog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/kali/fronted_player/src/components/LiveLog.vue","mtime":1725802251911},{"path":"/home/kali/fronted_player/node_modules/cache-loader/dist/cjs.js","mtime":1718176688802},{"path":"/home/kali/fronted_player/node_modules/babel-loader/lib/index.js","mtime":1718176688789},{"path":"/home/kali/fronted_player/node_modules/vuetify-loader/lib/loader.js","mtime":1718176689266},{"path":"/home/kali/fronted_player/node_modules/cache-loader/dist/cjs.js","mtime":1718176688802},{"path":"/home/kali/fronted_player/node_modules/vue-loader/lib/index.js","mtime":1718176689251}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJMaXZlTG9nIiwKICAgIGRhdGE6ICgpID0+ICh7CiAgICAgICAgbG9nczogW10sCiAgICAgICAgc3RyZWFtOiBudWxsLAogICAgfSksCiAgICBtb3VudGVkKCkgewogICAgICAgIHRoaXMuZ2V0U3RyZWFtKCkKICAgIH0sCgogICAgYmVmb3JlRGVzdHJveSgpIHsKICAgICAgICBjb25zb2xlLmxvZygxMTExKQogICAgICAgIHRoaXMuc3RyZWFtLmNsb3NlKCkKICAgIH0sCgogICAgbWV0aG9kczogewogICAgICAgIGdldFN0cmVhbSgpIHsKICAgICAgICAgICAgdGhpcy5zdHJlYW0gPSBuZXcgRXZlbnRTb3VyY2UodGhpcy51dGlscy5iYXNlVVJMICsgJy9saXZlbG9nJykKICAgICAgICAgICAgdGhpcy5zdHJlYW0ub25tZXNzYWdlID0gKGV2ZW50KSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSkKICAgICAgICAgICAgICAgIHN3aXRjaCAoZGF0YVsnVHlwZSddKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3VibWl0X2ZsYWcnOgogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZTogZGF0YVsnVGltZSddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgnbG9nLnN1Ym1pdF9mbGFnJywgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmcm9tJzogZGF0YVsnTWVzc2FnZSddWydGcm9tJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RvJzogZGF0YVsnTWVzc2FnZSddWydUbyddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFsbGVuZ2UnOiBkYXRhWydNZXNzYWdlJ11bJ0NoYWxsZW5nZSddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0aW1lJzogZGF0YVsnTWVzc2FnZSddWydTb2x2ZVRpbWUnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGV2ZW50LmRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICdjaGVja19kb3duJzoKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWU6IGRhdGFbJ1RpbWUnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ2xvZy5jaGVja19kb3duJywgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0ZWFtJzogZGF0YVsnTWVzc2FnZSddWydUZWFtJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYWxsZW5nZSc6IGRhdGFbJ01lc3NhZ2UnXVsnQ2hhbGxlbmdlJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgdGhpcy5zdHJlYW0ub25lcnJvciA9IGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycikKICAgICAgICAgICAgfTsKICAgICAgICB9LAogICAgICAgIHB1c2goZGF0YSkgewogICAgICAgICAgICBpZiAodGhpcy5sb2dzLmxlbmd0aCA+IDMwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmxvZ3MgPSB0aGlzLmxvZ3Muc2xpY2UoMCwgMzApCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5sb2dzLnVuc2hpZnQoZGF0YSkKICAgICAgICB9CiAgICB9Cn0K"},{"version":3,"sources":["LiveLog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LiveLog.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <div>\n        <v-simple-table :height=\"200\" v-if=\"logs.length !== 0\">\n            <template v-slot:default>\n                <tbody>\n                <tr v-for=\"(item, index) in logs\" v-bind:key=\"index\">\n                    <td>{{ item.message }}</td>\n                    <td width=\"220px\" style=\"text-align: right;\">{{ new Date(item.time * 1000).toLocaleString() }}</td>\n                </tr>\n                </tbody>\n            </template>\n        </v-simple-table>\n        <div style=\"height: 200px;\" v-else>\n            {{$t('log.no_data')}}\n        </div>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: \"LiveLog\",\n        data: () => ({\n            logs: [],\n            stream: null,\n        }),\n        mounted() {\n            this.getStream()\n        },\n\n        beforeDestroy() {\n            console.log(1111)\n            this.stream.close()\n        },\n\n        methods: {\n            getStream() {\n                this.stream = new EventSource(this.utils.baseURL + '/livelog')\n                this.stream.onmessage = (event) => {\n                    let data = JSON.parse(event.data)\n                    switch (data['Type']) {\n                        case 'submit_flag':\n                            this.push({\n                                time: data['Time'],\n                                message: this.$t('log.submit_flag', {\n                                    'from': data['Message']['From'],\n                                    'to': data['Message']['To'],\n                                    'challenge': data['Message']['Challenge'],\n                                    'time': data['Message']['SolveTime'],\n                                })\n                            })\n                            console.log(event.data);\n                            break;\n                        case 'check_down':\n                            this.push({\n                                time: data['Time'],\n                                message: this.$t('log.check_down', {\n                                    'team': data['Message']['Team'],\n                                    'challenge': data['Message']['Challenge'],\n                                })\n                            })\n                            break;\n                    }\n                };\n                this.stream.onerror = function (err) {\n                    console.log(err)\n                };\n            },\n            push(data) {\n                if (this.logs.length > 30) {\n                    this.logs = this.logs.slice(0, 30)\n                }\n                this.logs.unshift(data)\n            }\n        }\n    }\n</script>\n\n<style scoped>\n\n</style>"]}]}